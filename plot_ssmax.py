import matplotlib.pyplot as plt
base_train_losses=[10.82585620880127, 10.784880638122559, 10.699116706848145, 10.60825252532959, 10.433051109313965, 10.283995628356934, 10.160880088806152, 9.908658981323242, 9.569876670837402, 9.335067749023438, 8.93947696685791, 8.82616901397705, 8.541277885437012, 8.598210334777832, 8.001433372497559, 7.797420501708984, 7.654302597045898, 7.765763759613037, 8.082987785339355, 7.887848377227783, 7.457513332366943, 7.45208215713501, 7.169330596923828, 6.8218913078308105, 6.584665298461914, 6.532466888427734, 7.009146213531494, 7.409095287322998, 7.302377223968506, 7.57659387588501, 7.437869071960449, 7.4477128982543945, 7.3235955238342285, 7.8270487785339355, 8.167156219482422, 7.624915599822998, 7.342525482177734, 7.082790374755859, 7.042755126953125, 7.301264762878418, 7.154139995574951, 7.11639928817749, 6.919090747833252, 7.087906360626221, 6.991975784301758, 6.623381614685059, 6.520192623138428, 7.032665729522705, 6.722336292266846, 6.949984550476074, 6.722464084625244, 6.770384311676025, 6.908079624176025, 6.78615140914917, 6.934493541717529, 7.288425922393799, 7.057275295257568, 7.111759662628174, 6.446926593780518, 7.086083889007568, 7.180233001708984, 6.5603108406066895, 6.550426959991455, 6.6503071784973145, 6.752021789550781, 6.760375499725342, 6.439776420593262, 6.473808765411377, 7.042313575744629, 6.792208671569824, 6.604180812835693, 6.5202836990356445, 7.154942989349365, 6.115714073181152, 6.230141639709473, 6.726179599761963, 6.842774868011475, 6.5108489990234375, 6.468044281005859, 6.406233310699463, 6.526942729949951, 6.390736103057861, 6.410857677459717, 6.350401878356934, 6.611260890960693, 6.433270454406738, 6.224705219268799, 6.229925632476807, 6.707156658172607, 7.5494537353515625, 6.35627555847168, 6.433353900909424, 6.35240364074707, 6.574106216430664, 6.732667446136475, 6.791926860809326, 6.494816303253174, 6.52801513671875, 6.616312503814697, 6.48866081237793, 6.254879474639893, 6.507882118225098, 6.736127853393555, 6.630175590515137, 6.484147071838379, 5.548086643218994, 6.513724327087402, 6.309366703033447, 7.036093711853027, 6.7714457511901855, 6.2515130043029785, 6.261003017425537, 6.4648518562316895, 6.5855712890625, 6.25451135635376, 6.646122455596924, 6.271420478820801, 6.175047874450684, 6.4593915939331055, 6.687919616699219, 7.021131992340088, 6.507901191711426, 6.5104451179504395, 6.7918381690979, 6.805713176727295, 6.276036262512207, 6.301706314086914, 6.733203887939453, 6.693833351135254, 6.518711090087891, 6.047043323516846, 6.472937107086182, 6.5028300285339355, 6.88794469833374, 6.211289405822754, 6.374115467071533, 5.885310649871826, 6.480216979980469, 6.118809700012207, 6.414759159088135, 6.592223167419434, 6.540919780731201, 6.536227226257324, 6.3290696144104, 6.466311454772949, 6.160926342010498, 6.61705207824707, 6.294842720031738, 6.195817470550537, 5.9573283195495605, 6.218923091888428, 6.403043746948242, 6.054087162017822, 6.409801006317139, 6.299487590789795, 5.851832389831543, 6.47784948348999, 6.234658718109131, 5.971436977386475, 6.226312160491943, 5.999484062194824, 6.161835670471191, 6.077324867248535, 6.2596845626831055, 6.265130043029785, 6.632936477661133, 6.580301761627197, 6.754573345184326, 6.369532108306885, 5.918277740478516, 6.450528621673584, 6.394863128662109, 6.261687278747559, 6.472249507904053, 6.307519912719727, 6.160066604614258, 6.22285795211792, 6.146141529083252, 6.409348964691162, 6.233654499053955, 6.420566082000732, 5.9361653327941895, 6.3963775634765625, 6.531766891479492, 7.289532661437988, 6.604990005493164, 6.170719623565674, 6.045000076293945, 6.249481201171875, 6.2534027099609375, 6.030508518218994, 5.877535343170166, 5.839303493499756, 6.256455898284912, 6.25189733505249, 6.346591472625732, 5.772721290588379, 5.705320835113525, 6.1985554695129395, 6.209281921386719, 6.3401689529418945, 5.946761131286621, 5.8303093910217285, 5.9660234451293945, 6.058091163635254, 5.988161563873291, 5.9575676918029785, 6.039177894592285, 5.863630771636963, 6.289937496185303, 6.192868709564209, 6.540976524353027, 6.053487777709961, 6.181642532348633, 6.082951068878174, 6.303934097290039, 6.198483943939209, 6.140425682067871, 5.885920524597168, 5.577782154083252, 6.060612678527832, 6.004725933074951, 6.035670280456543, 6.356378555297852, 5.945833206176758, 5.9061150550842285, 5.92197847366333, 5.977158546447754, 5.957415580749512, 5.7552032470703125, 6.296193599700928, 5.838487148284912, 6.200153350830078, 6.075756072998047, 6.104856967926025, 5.794504642486572, 6.063595771789551, 5.576282024383545, 5.713264465332031, 5.700616359710693, 6.201455593109131, 6.776123523712158, 6.410431861877441, 6.287161350250244, 6.057332515716553, 6.114549160003662, 6.1602253913879395, 5.966168403625488, 5.927411079406738, 6.241907596588135, 6.066112518310547, 6.875154495239258, 6.375354766845703, 6.2359619140625, 5.970662593841553, 6.0979437828063965, 5.643723011016846, 5.985466957092285, 6.255207538604736, 6.302762031555176, 5.926636695861816, 6.097214221954346, 6.041370868682861, 6.143271446228027, 6.016989707946777, 6.172323226928711, 6.166415214538574, 5.802987098693848, 6.101321220397949, 6.927830219268799, 6.134308815002441, 6.068231105804443, 6.04379415512085, 5.912830829620361, 6.040406703948975, 5.8510260581970215, 5.995633602142334, 6.474512100219727, 5.839212894439697, 5.588069438934326, 5.978389739990234, 6.086148738861084, 6.021205425262451, 5.878478050231934, 6.010682106018066, 6.012414932250977, 6.430435657501221, 6.425103664398193, 5.967074871063232, 5.976769924163818, 6.002437591552734, 6.25813102722168, 5.962432861328125, 5.951175689697266, 5.884697914123535, 5.4324846267700195, 5.393420219421387, 5.976566791534424, 5.751788139343262, 5.660292625427246, 5.839538097381592, 5.82919979095459, 6.021531581878662, 6.097224235534668, 5.763739585876465, 6.06372594833374, 5.881417274475098, 5.998061656951904, 5.916079044342041, 5.597354412078857, 5.812633991241455, 6.285603046417236, 6.002562999725342, 5.9574785232543945, 5.794417858123779, 6.1460161209106445, 5.90204381942749, 5.704613208770752, 5.740532875061035, 5.90294075012207, 5.6469340324401855, 5.742038249969482, 5.821743965148926, 5.943146705627441, 5.55813455581665, 6.001028060913086, 5.610212326049805, 5.677804946899414, 5.867603302001953, 5.659070014953613, 5.622593402862549, 5.712683200836182, 5.793762683868408, 6.063650131225586, 6.352680206298828, 5.7050628662109375, 5.467104911804199, 5.834450721740723, 5.884177207946777, 5.493447780609131, 5.570375919342041, 6.052606105804443, 5.936569690704346, 5.632158279418945, 5.769429683685303, 5.470729351043701, 5.842126369476318, 6.013433456420898, 6.059791564941406, 5.6673903465271, 6.034902572631836, 5.683108329772949, 5.727684497833252, 5.689575672149658, 5.6981987953186035, 6.077848434448242, 5.865484237670898, 5.593722343444824, 5.914495468139648, 5.355151176452637, 5.8295578956604, 5.792518615722656, 5.609670162200928, 5.523560523986816, 5.60640287399292, 5.847231864929199, 6.620486259460449, 5.047111511230469, 5.695132732391357, 5.598949432373047, 5.777345657348633, 5.8122239112854, 6.043644428253174, 5.677682399749756, 6.153960227966309, 5.89151668548584, 5.866135120391846, 5.846986770629883, 5.934767723083496, 5.856818199157715, 5.884213447570801, 5.896254062652588, 6.05519962310791, 6.013839244842529, 6.111661434173584, 5.5743865966796875, 5.745058059692383, 5.8207173347473145, 6.411631107330322, 6.306309223175049, 6.251656532287598, 6.008327960968018, 5.609827995300293, 5.769048690795898, 5.6137213706970215, 5.895859718322754, 5.693670749664307, 5.81001091003418, 5.678106784820557, 5.877692699432373, 5.677737712860107, 5.627721309661865, 6.083514213562012, 5.755203723907471, 5.714616298675537, 6.2551493644714355, 5.332313060760498, 5.647930145263672, 5.9857001304626465, 6.238055229187012, 6.192640781402588, 5.983030796051025, 6.241761207580566, 5.6914381980896, 6.0577311515808105, 5.796525001525879, 5.8328657150268555, 5.596739768981934, 6.164383411407471, 5.792806148529053, 5.912102222442627, 5.92999267578125, 5.898346424102783, 5.956761837005615, 5.820992946624756, 5.78764533996582, 5.474819183349609, 5.840597152709961, 5.726185321807861, 5.864437103271484, 5.796474456787109, 6.071149826049805, 5.522256851196289, 5.757999420166016, 5.708864212036133, 5.741765975952148, 5.69557523727417, 5.843623161315918, 5.631945610046387, 5.883923530578613, 6.237501621246338, 5.6665449142456055, 5.63677453994751, 6.030006408691406, 5.817263126373291, 5.730417728424072, 5.586745262145996, 5.677680015563965, 5.567470073699951, 5.578828811645508, 6.508305072784424, 6.219814777374268, 5.685766220092773, 5.643174648284912, 5.588447093963623, 5.689706802368164, 5.452515602111816, 5.855531692504883, 5.526737689971924, 5.858400821685791, 5.954549312591553, 5.808448791503906, 5.500692844390869, 5.586713790893555, 6.119136333465576, 5.640930652618408, 5.563236236572266, 5.4459967613220215, 5.880647659301758, 5.6826348304748535, 5.235044956207275, 5.815805435180664, 5.308043956756592, 5.561611175537109, 5.904154300689697, 5.313522815704346, 5.5654826164245605, 5.890307903289795, 5.683218955993652, 5.3489813804626465, 4.460676670074463, 4.8587565422058105, 5.755213260650635, 5.588494300842285, 5.697573184967041, 5.981691837310791, 5.657857894897461, 5.411991119384766, 5.64353084564209, 5.499215602874756, 5.26220178604126, 5.9337263107299805, 5.864344120025635, 5.735420227050781, 5.739479064941406, 5.4014892578125, 5.938179969787598, 6.209112644195557, 5.625573635101318, 5.720451831817627, 5.46265172958374, 5.472995758056641, 5.798017978668213, 5.688673496246338, 5.45232629776001, 5.310096740722656, 5.377833366394043, 5.210041046142578, 5.266138076782227, 5.657465934753418, 5.728916645050049, 5.618829727172852, 5.8802032470703125, 5.853724956512451, 5.843693256378174, 5.357972621917725, 5.46998405456543, 5.923508644104004, 5.822639465332031, 5.636645317077637, 5.8699846267700195, 5.924596786499023, 5.5340681076049805, 5.562525749206543, 5.545796871185303, 5.785431861877441, 5.675154209136963, 5.552527904510498, 5.76265287399292, 5.7855753898620605, 5.525468826293945, 5.566215991973877, 5.860918045043945, 5.6324143409729, 5.544547080993652, 5.822535514831543, 5.7309184074401855, 5.7205352783203125, 5.710607528686523, 5.865373134613037, 5.691550254821777, 5.667882442474365, 5.626877784729004, 6.248661994934082, 5.743151664733887, 5.774166107177734, 5.598812103271484, 5.783986568450928, 5.791096210479736, 5.607646465301514, 6.119136810302734, 5.792375087738037, 5.43215799331665, 5.64210844039917, 5.387484550476074, 5.59263801574707, 5.829315185546875, 5.412961483001709, 5.743521690368652, 5.623234272003174, 5.448331356048584, 5.4762420654296875, 5.581033706665039, 5.479572772979736, 5.725142955780029, 5.104674816131592, 5.857696533203125, 5.397021770477295, 5.659684181213379, 6.035642623901367, 6.957273006439209, 6.44182825088501, 5.811537265777588, 6.527751922607422, 5.6852946281433105, 6.045743465423584, 5.595645904541016, 6.180083751678467, 5.387423038482666, 5.826473236083984, 5.18483304977417, 5.197727680206299, 6.123535633087158, 5.681792259216309, 5.480926036834717, 5.197944641113281, 5.282120704650879, 5.335872173309326, 5.329161167144775, 5.783994197845459, 5.429824352264404, 5.7443389892578125, 5.59422492980957, 5.388211727142334, 5.451602458953857, 5.21900749206543, 5.602324485778809, 5.888354301452637, 5.79681396484375, 5.486073017120361, 5.338736534118652, 5.577449798583984, 5.147911548614502, 5.225699424743652, 5.0424723625183105, 5.740099906921387, 5.532864570617676, 5.7218098640441895, 5.698655605316162, 5.2176361083984375, 5.646098613739014, 5.820671081542969, 5.467617988586426, 5.550071716308594, 5.8955841064453125, 5.410299777984619, 5.602077484130859, 5.172149658203125, 5.608249664306641, 5.48783016204834, 5.459619045257568, 5.379082679748535, 5.472103118896484, 5.543217658996582, 5.220133304595947, 5.454187393188477, 5.702929496765137, 5.331587791442871, 5.62471866607666, 5.847808837890625, 5.991874694824219, 5.255354881286621, 5.487880706787109, 5.456086158752441, 5.455507278442383, 5.432025909423828, 5.573536396026611, 5.627808570861816, 5.676564693450928, 5.1532301902771, 4.932291507720947, 5.783761501312256, 5.5746989250183105, 5.511887550354004, 5.909515380859375, 5.48084831237793, 5.532444953918457, 5.683757781982422, 5.522521018981934, 5.426867961883545, 5.350688457489014, 5.675119876861572, 5.660462379455566, 5.402206897735596, 5.493730068206787, 5.528008460998535, 5.541231632232666, 5.541446208953857, 5.245390892028809, 5.502082347869873, 5.3850579261779785, 5.379899024963379, 6.259732723236084, 5.352331161499023, 5.345299243927002, 5.326650142669678, 5.197346210479736, 5.352702617645264, 5.570687294006348, 5.632538318634033, 5.187389850616455, 5.452077388763428, 5.3515543937683105, 5.755867004394531, 5.583161354064941, 5.413547515869141, 5.749621391296387, 5.434221267700195, 5.596904754638672, 5.337409496307373, 5.197855472564697, 5.365169048309326, 5.366824150085449, 5.655354022979736, 5.4012885093688965, 5.370368003845215, 5.634119987487793, 5.555529594421387, 5.664383888244629, 5.315756320953369, 5.400741100311279, 5.1136274337768555, 5.358474254608154, 5.514354228973389, 5.011837482452393, 5.693999767303467, 6.546088218688965, 5.807610988616943, 5.32995080947876, 5.424281597137451, 5.858110427856445, 5.224518775939941, 5.305454254150391, 5.378959655761719, 5.60979700088501, 5.266728401184082, 5.492379188537598, 5.605235576629639, 5.340731620788574, 5.430075168609619, 5.467369079589844, 5.330249309539795, 5.670617580413818, 5.250387668609619, 5.120678901672363, 5.179328441619873, 6.1401286125183105, 5.102564334869385, 5.380916595458984, 5.520923614501953, 5.312553882598877, 5.693455696105957, 5.495753288269043, 5.446261405944824, 5.221201419830322, 5.590335369110107, 5.025663375854492, 5.241212844848633, 5.274495601654053, 5.3276567459106445, 5.358400344848633, 5.388225555419922, 5.176599025726318, 5.1147356033325195, 5.721325874328613, 5.594949245452881, 5.4847517013549805, 5.246832847595215, 5.192206859588623, 5.385148525238037, 5.538678169250488, 5.458532810211182, 5.349404335021973, 5.08408784866333, 5.150086402893066, 5.852451801300049, 5.300344467163086, 5.660562038421631, 5.2659783363342285, 6.194084644317627, 6.163964748382568, 5.315141201019287, 5.316372394561768, 5.470322608947754, 5.577709197998047, 5.5436906814575195, 5.602849960327148, 5.357113838195801, 5.305474281311035, 5.224038124084473, 4.856466770172119, 5.522197246551514, 5.379634857177734, 5.638899803161621, 5.641138553619385, 5.410638332366943, 5.5767107009887695, 5.050415992736816, 5.176219463348389, 5.358113765716553, 5.235374927520752, 5.245580196380615, 5.396110534667969, 5.3918137550354, 5.642062187194824, 5.035007476806641, 5.382540702819824, 5.207657337188721, 5.486347198486328, 5.470954418182373, 5.371093273162842, 5.35019063949585, 5.411584854125977, 5.342069149017334, 5.499927043914795, 5.523847579956055, 5.720512866973877, 5.354006290435791, 5.230896949768066, 5.760144233703613, 5.400055885314941, 5.339400291442871, 5.56898832321167, 5.094119548797607, 5.057694435119629, 5.426046848297119, 5.576223850250244, 5.622402191162109, 5.3800129890441895, 5.159638404846191, 5.259848594665527, 5.294435977935791, 5.447082042694092, 5.3163743019104, 5.201644420623779, 5.682925701141357, 5.30374002456665, 5.240541458129883, 4.9575419425964355, 5.437930107116699, 5.250920295715332, 5.0360918045043945, 5.412868022918701, 5.42070198059082, 5.243422508239746, 5.037746906280518, 5.453711032867432, 5.725330352783203, 5.503579616546631, 5.227841377258301, 5.367457866668701, 5.239990711212158, 5.343414783477783, 5.725227355957031, 5.701555252075195, 5.105756759643555, 5.153303146362305, 5.0577921867370605, 5.451227188110352, 5.011502742767334, 5.103819370269775, 5.412071704864502, 5.089290618896484, 5.313266754150391, 5.316229343414307, 5.256297588348389, 5.168364524841309, 5.567216873168945, 5.0998663902282715, 5.451380729675293, 5.337499618530273, 5.4227728843688965, 5.603036880493164, 5.174278259277344, 5.276946067810059, 5.255045413970947, 5.106034755706787, 5.444663047790527, 4.963178634643555, 4.9545817375183105, 5.086614608764648, 5.097458839416504, 5.1925506591796875, 5.12608003616333, 5.208543300628662, 5.133159637451172, 5.4241414070129395, 5.582951545715332, 5.904098033905029, 5.7473039627075195, 5.2823591232299805, 5.316609859466553, 5.732346057891846, 4.626649856567383, 5.05652379989624, 5.645286560058594, 5.442716598510742, 5.49770450592041, 5.14302396774292, 5.141850471496582, 5.168240070343018, 4.995752811431885, 5.162757396697998, 5.010668754577637, 5.13720178604126, 5.138389587402344, 4.7667927742004395, 5.036394119262695, 5.19541597366333, 4.789666175842285, 5.252979278564453, 5.166533946990967, 4.919633388519287, 5.39257287979126, 5.278878211975098, 5.321658134460449, 5.288395404815674, 4.9233856201171875, 5.391308307647705, 5.253705978393555, 5.25728702545166, 5.255775451660156, 5.156134128570557, 5.439326763153076, 5.277185440063477, 5.336780548095703, 4.753150463104248, 5.466734886169434, 5.393401145935059, 5.204596519470215, 5.044628143310547, 5.309546947479248, 5.1031999588012695, 5.492133140563965, 5.056103229522705, 5.115577220916748, 5.258865833282471, 5.133263111114502, 5.505672454833984, 5.027466297149658, 5.308351039886475, 5.470658302307129, 5.118680953979492, 5.309892654418945, 5.254753112792969, 5.127696990966797, 5.21258020401001, 5.107519149780273, 5.143599033355713, 5.438857078552246, 5.139036178588867, 5.0713677406311035, 4.955831527709961, 5.2784810066223145, 5.513933181762695, 5.158873081207275, 5.318498134613037, 5.484732627868652, 5.320300579071045, 5.260929107666016, 5.338518142700195, 5.4587249755859375, 5.296795845031738, 5.104373931884766, 5.168590545654297, 5.082322597503662, 5.224680423736572, 5.361209392547607, 5.147695541381836, 4.949137210845947, 5.21597146987915, 5.080301284790039, 5.344295024871826, 5.353678226470947, 5.278903961181641, 5.042954444885254, 5.45310115814209, 5.401562213897705, 5.403812408447266, 5.602488994598389, 5.368570804595947, 5.353823661804199, 4.9478983879089355, 5.170498847961426, 5.313385486602783, 5.11290168762207, 5.720645427703857, 5.442633628845215, 4.902096748352051, 5.152245044708252, 5.6592206954956055, 5.145515441894531, 5.126444339752197, 4.931426048278809, 5.134573936462402, 5.06829309463501, 5.130210876464844, 5.401913642883301, 5.393517971038818, 5.290396690368652, 5.211349010467529, 5.1245527267456055, 5.020881652832031, 5.413405895233154, 4.9555888175964355, 5.279972076416016, 5.02727746963501, 5.137666702270508, 5.131351470947266, 5.538561820983887, 4.9565887451171875, 5.059027671813965, 4.822535037994385, 5.323064804077148, 4.998430252075195, 4.8560614585876465, 5.148460865020752, 6.070291519165039, 4.850254058837891, 4.7566094398498535, 5.091878414154053, 4.8994832038879395, 5.12501859664917, 4.876858234405518, 4.897523403167725, 5.22694730758667, 5.069927215576172, 5.467726707458496, 5.022176265716553, 4.844925880432129]
base_val_losses={0: 10.825848579406738, 125: 6.551115036010742, 250: 6.112812042236328, 375: 5.881729602813721, 500: 5.738409042358398, 625: 5.5869879722595215, 750: 5.422008514404297, 875: 5.286458969116211, 1000: 5.215960502624512}
ssmax_train_losses=[10.82585620880127, 10.784880638122559, 10.6990966796875, 10.608137130737305, 10.432588577270508, 10.283947944641113, 10.160778045654297, 9.908447265625, 9.56949520111084, 9.334404945373535, 8.93903636932373, 8.826272964477539, 8.541008949279785, 8.597908020019531, 8.00085735321045, 7.79691743850708, 7.6539764404296875, 7.765488624572754, 8.08206844329834, 7.888340473175049, 7.456092357635498, 7.452683925628662, 7.174588203430176, 6.826504707336426, 6.5846428871154785, 6.528995990753174, 7.0138936042785645, 7.413959503173828, 7.305871963500977, 7.576719284057617, 7.4402618408203125, 7.448306083679199, 7.322869777679443, 7.826598167419434, 8.1632080078125, 7.625283718109131, 7.342625617980957, 7.080624103546143, 7.042506694793701, 7.301779270172119, 7.155970573425293, 7.116724014282227, 6.92051887512207, 7.089314937591553, 6.993305683135986, 6.623861312866211, 6.520788669586182, 7.0321736335754395, 6.72363805770874, 6.952775001525879, 6.722699165344238, 6.769631862640381, 6.910158634185791, 6.7870025634765625, 6.935604095458984, 7.292320728302002, 7.060254096984863, 7.114717483520508, 6.448941707611084, 7.088356971740723, 7.182822227478027, 6.561558723449707, 6.551821231842041, 6.649876117706299, 6.755725383758545, 6.7654805183410645, 6.43822717666626, 6.475429058074951, 7.0437164306640625, 6.793208599090576, 6.606142997741699, 6.523770332336426, 7.155673503875732, 6.123226642608643, 6.233341217041016, 6.728267192840576, 6.846681594848633, 6.515232563018799, 6.4678168296813965, 6.405113220214844, 6.531309127807617, 6.393085956573486, 6.414703845977783, 6.3523969650268555, 6.615847110748291, 6.434752464294434, 6.225631237030029, 6.2308735847473145, 6.707691192626953, 7.5513811111450195, 6.357928276062012, 6.433048248291016, 6.354658603668213, 6.57757568359375, 6.731783390045166, 6.787339210510254, 6.500916481018066, 6.533957481384277, 6.619957447052002, 6.489711761474609, 6.2576799392700195, 6.514112949371338, 6.719130516052246, 6.631857395172119, 6.485073566436768, 5.545802116394043, 6.516592502593994, 6.310449600219727, 7.034059524536133, 6.773095607757568, 6.248698711395264, 6.262816905975342, 6.4700188636779785, 6.578821659088135, 6.256589889526367, 6.646221160888672, 6.27316951751709, 6.173842430114746, 6.468696594238281, 6.693908214569092, 7.026430130004883, 6.510178565979004, 6.514156341552734, 6.798733234405518, 6.81086540222168, 6.278931140899658, 6.300365924835205, 6.728982925415039, 6.69676399230957, 6.51323938369751, 6.045736312866211, 6.467806816101074, 6.507924556732178, 6.884615421295166, 6.210558891296387, 6.376993656158447, 5.874655723571777, 6.4777021408081055, 6.11655330657959, 6.418272018432617, 6.592095375061035, 6.538657188415527, 6.533216953277588, 6.334221839904785, 6.463944911956787, 6.157311916351318, 6.620831489562988, 6.296313285827637, 6.190921306610107, 5.959702491760254, 6.2227911949157715, 6.391923904418945, 6.054676532745361, 6.401974678039551, 6.302579402923584, 5.853846549987793, 6.480225563049316, 6.236186504364014, 5.957942008972168, 6.232265949249268, 6.000586032867432, 6.164960861206055, 6.081474781036377, 6.261346817016602, 6.262304782867432, 6.629276752471924, 6.579275131225586, 6.7386794090271, 6.368825435638428, 5.918819904327393, 6.454821586608887, 6.399744033813477, 6.266772747039795, 6.476525783538818, 6.317871570587158, 6.166080474853516, 6.220389366149902, 6.149013042449951, 6.419507026672363, 6.240653991699219, 6.420868873596191, 5.938660144805908, 6.401304721832275, 6.533816814422607, 7.276991367340088, 6.602691650390625, 6.177964687347412, 6.055017948150635, 6.257345676422119, 6.254475116729736, 6.029576301574707, 5.874240398406982, 5.83833122253418, 6.260675430297852, 6.258495330810547, 6.350877285003662, 5.770514488220215, 5.710880279541016, 6.1968207359313965, 6.2157883644104, 6.3371782302856445, 5.9487104415893555, 5.831474304199219, 5.96868896484375, 6.066019058227539, 5.994121074676514, 5.9624433517456055, 6.043508529663086, 5.869746685028076, 6.283603191375732, 6.198479652404785, 6.538374900817871, 6.065130233764648, 6.1803975105285645, 6.0836100578308105, 6.3073320388793945, 6.200476169586182, 6.1451616287231445, 5.886046409606934, 5.582698822021484, 6.0610785484313965, 6.007529258728027, 6.03468656539917, 6.357754230499268, 5.948261260986328, 5.908740997314453, 5.921627521514893, 5.975696086883545, 5.960643291473389, 5.762600421905518, 6.300854682922363, 5.8409423828125, 6.212132453918457, 6.080208778381348, 6.112234592437744, 5.801150798797607, 6.074677467346191, 5.57920503616333, 5.716797828674316, 5.705429553985596, 6.202625751495361, 6.77477502822876, 6.390930652618408, 6.289892196655273, 6.064563274383545, 6.125527858734131, 6.165822505950928, 5.967133522033691, 5.930405616760254, 6.249086856842041, 6.0736236572265625, 6.86621618270874, 6.387789249420166, 6.2464680671691895, 5.978222370147705, 6.10701847076416, 5.655599594116211, 5.983280658721924, 6.247879981994629, 6.306643009185791, 5.913511276245117, 6.102771759033203, 6.049382209777832, 6.147899627685547, 6.026295185089111, 6.1779093742370605, 6.176857948303223, 5.81687593460083, 6.095120429992676, 6.937154769897461, 6.135717391967773, 6.077595233917236, 6.055369853973389, 5.9088897705078125, 6.045284748077393, 5.855443954467773, 6.004875183105469, 6.480801105499268, 5.849123954772949, 5.583090782165527, 5.987932205200195, 6.095710754394531, 6.019157409667969, 5.891687393188477, 6.020927429199219, 6.0220136642456055, 6.40143346786499, 6.397446632385254, 5.9644060134887695, 5.989126682281494, 6.015266418457031, 6.266961574554443, 5.975499153137207, 5.956084251403809, 5.895081520080566, 5.433041095733643, 5.400272846221924, 5.981148719787598, 5.760838508605957, 5.670237064361572, 5.845357894897461, 5.839349269866943, 6.021749973297119, 6.107962608337402, 5.768333911895752, 6.067845821380615, 5.886244297027588, 6.0018181800842285, 5.91918420791626, 5.597175598144531, 5.8132829666137695, 6.294167995452881, 6.005967140197754, 5.959519386291504, 5.793619632720947, 6.147627830505371, 5.9065399169921875, 5.7112812995910645, 5.744060516357422, 5.908823013305664, 5.649531364440918, 5.745658874511719, 5.823487758636475, 5.946718215942383, 5.561007022857666, 6.01697301864624, 5.606359004974365, 5.686007976531982, 5.859426021575928, 5.665935039520264, 5.6301774978637695, 5.724796295166016, 5.805757999420166, 6.047088623046875, 6.358712673187256, 5.712946891784668, 5.467329025268555, 5.8449320793151855, 5.890450954437256, 5.498689651489258, 5.575255870819092, 6.075952529907227, 5.935315132141113, 5.641355037689209, 5.774849891662598, 5.462024211883545, 5.844214916229248, 6.016788005828857, 6.067754745483398, 5.670418739318848, 6.0373358726501465, 5.685266017913818, 5.728575706481934, 5.696843147277832, 5.7097320556640625, 6.083316802978516, 5.872762203216553, 5.601158618927002, 5.918758869171143, 5.364268779754639, 5.835238933563232, 5.799561500549316, 5.618314743041992, 5.523403644561768, 5.615954875946045, 5.853361129760742, 6.617393970489502, 5.052337169647217, 5.7063798904418945, 5.608389377593994, 5.765954494476318, 5.816861152648926, 6.054316997528076, 5.678779602050781, 6.160250186920166, 5.900005340576172, 5.871984481811523, 5.851475238800049, 5.945876121520996, 5.854629993438721, 5.8927226066589355, 5.891788005828857, 6.059042930603027, 6.027201175689697, 6.116600036621094, 5.587366580963135, 5.735865592956543, 5.8217387199401855, 6.392678737640381, 6.25793981552124, 6.247001647949219, 6.011718273162842, 5.616421699523926, 5.762818813323975, 5.60843563079834, 5.904599666595459, 5.697356224060059, 5.8082380294799805, 5.688162326812744, 5.879039764404297, 5.678139686584473, 5.625529766082764, 6.090422630310059, 5.750339508056641, 5.7088141441345215, 6.25057315826416, 5.347949028015137, 5.650809288024902, 5.992448329925537, 6.2639851570129395, 6.2101359367370605, 6.008402347564697, 6.258988857269287, 5.7012939453125, 6.063119888305664, 5.810507297515869, 5.840731143951416, 5.604563236236572, 6.173894882202148, 5.796119213104248, 5.925931930541992, 5.92219877243042, 5.86536979675293, 5.941733360290527, 5.818667411804199, 5.804078578948975, 5.471201419830322, 5.8511061668396, 5.728431701660156, 5.8712897300720215, 5.786444187164307, 6.069352149963379, 5.5369038581848145, 5.764482498168945, 5.714674949645996, 5.7530927658081055, 5.704172134399414, 5.849807262420654, 5.628445625305176, 5.893184185028076, 6.242439270019531, 5.6753387451171875, 5.646298885345459, 6.029741287231445, 5.823479175567627, 5.741197109222412, 5.586863994598389, 5.691661357879639, 5.585826873779297, 5.587854385375977, 6.528314590454102, 6.211322784423828, 5.684725284576416, 5.656140327453613, 5.59467077255249, 5.686540603637695, 5.460567474365234, 5.862893581390381, 5.5370659828186035, 5.859163761138916, 5.963477611541748, 5.820428371429443, 5.497456073760986, 5.598527908325195, 6.1262431144714355, 5.651837348937988, 5.575857639312744, 5.457406520843506, 5.892261028289795, 5.690864562988281, 5.244014263153076, 5.844915866851807, 5.314231872558594, 5.570207595825195, 5.913182258605957, 5.326052188873291, 5.572244167327881, 5.888057231903076, 5.696257591247559, 5.356265068054199, 4.469374179840088, 4.861632347106934, 5.76597785949707, 5.590156078338623, 5.705541610717773, 5.982632637023926, 5.670414447784424, 5.423191070556641, 5.655693054199219, 5.5042338371276855, 5.2807393074035645, 5.936582565307617, 5.861693382263184, 5.754704475402832, 5.746605396270752, 5.404297351837158, 5.948519229888916, 6.202834129333496, 5.625030040740967, 5.728869438171387, 5.475068092346191, 5.481683254241943, 5.792826175689697, 5.677883148193359, 5.4506731033325195, 5.291764736175537, 5.378326416015625, 5.210826396942139, 5.2747955322265625, 5.674410820007324, 5.748626708984375, 5.636696815490723, 5.885875225067139, 5.856495380401611, 5.871489524841309, 5.373839855194092, 5.482123374938965, 5.935791492462158, 5.827237129211426, 5.638439178466797, 5.8710618019104, 5.9312872886657715, 5.5213470458984375, 5.561307430267334, 5.551671981811523, 5.800052165985107, 5.674206256866455, 5.55178689956665, 5.760741710662842, 5.795047283172607, 5.517581939697266, 5.5709452629089355, 5.8632965087890625, 5.63878870010376, 5.55740213394165, 5.830319404602051, 5.73906946182251, 5.710470676422119, 5.709169864654541, 5.872033596038818, 5.690972805023193, 5.664299011230469, 5.638384819030762, 6.229616641998291, 5.741873264312744, 5.768802165985107, 5.5872931480407715, 5.777556896209717, 5.796839714050293, 5.608935832977295, 6.128883361816406, 5.81013822555542, 5.440651893615723, 5.651726245880127, 5.397670745849609, 5.591416358947754, 5.834839820861816, 5.4290547370910645, 5.7379961013793945, 5.633859634399414, 5.458295822143555, 5.484851360321045, 5.573428630828857, 5.465212821960449, 5.729116916656494, 5.1034626960754395, 5.859755992889404, 5.4065141677856445, 5.649065971374512, 6.041294097900391, 6.887099266052246, 6.443948745727539, 5.808934688568115, 6.527940273284912, 5.694581031799316, 6.054720878601074, 5.604702949523926, 6.182004928588867, 5.390415191650391, 5.834214210510254, 5.193598747253418, 5.206955909729004, 6.115958213806152, 5.6798295974731445, 5.494800090789795, 5.206104278564453, 5.283638000488281, 5.338168621063232, 5.338927268981934, 5.768185138702393, 5.4413557052612305, 5.749757289886475, 5.598018646240234, 5.382681846618652, 5.463992595672607, 5.227985858917236, 5.596580982208252, 5.880986213684082, 5.7957658767700195, 5.475543022155762, 5.343746185302734, 5.547591686248779, 5.1515021324157715, 5.2056565284729, 5.029978275299072, 5.72969388961792, 5.536269664764404, 5.708659648895264, 5.698227882385254, 5.216768741607666, 5.644904613494873, 5.828047752380371, 5.465641498565674, 5.540733814239502, 5.885371208190918, 5.412378787994385, 5.5981855392456055, 5.194221496582031, 5.612721920013428, 5.483850479125977, 5.466777801513672, 5.375182628631592, 5.482782363891602, 5.541299343109131, 5.224986553192139, 5.463261127471924, 5.706939697265625, 5.333202362060547, 5.633912086486816, 5.836627006530762, 5.974548816680908, 5.255207061767578, 5.501152515411377, 5.462813377380371, 5.4576873779296875, 5.430466651916504, 5.589463710784912, 5.631910800933838, 5.691384792327881, 5.139714241027832, 4.92720365524292, 5.763906478881836, 5.570552825927734, 5.512942790985107, 5.901918888092041, 5.484519958496094, 5.550894737243652, 5.671889781951904, 5.525747776031494, 5.434035778045654, 5.355439186096191, 5.669473171234131, 5.650969982147217, 5.399927616119385, 5.487706661224365, 5.5384697914123535, 5.553055763244629, 5.551137447357178, 5.25601863861084, 5.507266998291016, 5.386678695678711, 5.377140045166016, 6.251989364624023, 5.352185249328613, 5.356300354003906, 5.271110534667969, 5.18992280960083, 5.356988906860352, 5.577735424041748, 5.635621547698975, 5.189168930053711, 5.449824333190918, 5.3608784675598145, 5.759643077850342, 5.575029373168945, 5.417577743530273, 5.748820781707764, 5.421264171600342, 5.5839409828186035, 5.3348188400268555, 5.201325416564941, 5.369802951812744, 5.342089653015137, 5.534829139709473, 5.392975807189941, 5.372797012329102, 5.636729717254639, 5.564701080322266, 5.638014793395996, 5.315607070922852, 5.408867835998535, 5.124212265014648, 5.357346057891846, 5.505221366882324, 5.000692844390869, 5.668193340301514, 6.529182434082031, 5.789928913116455, 5.318154335021973, 5.414188861846924, 5.838808536529541, 5.223846435546875, 5.29207706451416, 5.385893821716309, 5.615672588348389, 5.274952411651611, 5.4714579582214355, 5.606874465942383, 5.336581230163574, 5.417585372924805, 5.467796325683594, 5.321090221405029, 5.667682647705078, 5.241640090942383, 5.113544940948486, 5.182219982147217, 6.10218620300293, 5.0964155197143555, 5.386025428771973, 5.501247882843018, 5.300382614135742, 5.679003715515137, 5.448155879974365, 5.442475318908691, 5.2140583992004395, 5.579960346221924, 5.024358749389648, 5.218372821807861, 5.235824108123779, 5.34967565536499, 5.35419225692749, 5.364425182342529, 5.188290596008301, 5.118271350860596, 5.715517044067383, 5.549782752990723, 5.466100692749023, 5.240900039672852, 5.18193244934082, 5.344643592834473, 5.536938667297363, 5.454422950744629, 5.345248699188232, 5.076200485229492, 5.142927169799805, 5.824478626251221, 5.306467056274414, 5.632652282714844, 5.277116298675537, 6.1832499504089355, 6.165722370147705, 5.313141822814941, 5.29921817779541, 5.461101531982422, 5.571989059448242, 5.539208889007568, 5.589401721954346, 5.34315299987793, 5.297715187072754, 5.213974475860596, 4.835277557373047, 5.532865524291992, 5.364620208740234, 5.622178554534912, 5.63447380065918, 5.3884735107421875, 5.570889472961426, 5.039861679077148, 5.172367572784424, 5.3443193435668945, 5.242828369140625, 5.230264186859131, 5.395712852478027, 5.393282413482666, 5.638762950897217, 5.039927959442139, 5.384886264801025, 5.220768928527832, 5.470816612243652, 5.455074787139893, 5.361629009246826, 5.359414100646973, 5.4023332595825195, 5.340902328491211, 5.495936870574951, 5.5247907638549805, 5.700245380401611, 5.32749080657959, 5.22927713394165, 5.761882305145264, 5.383120059967041, 5.334978103637695, 5.5474724769592285, 5.049428462982178, 5.0233001708984375, 5.424752235412598, 5.570937633514404, 5.615767955780029, 5.38301944732666, 5.1410675048828125, 5.259554386138916, 5.292890548706055, 5.462588787078857, 5.334794521331787, 5.202171325683594, 5.674699783325195, 5.273695945739746, 5.246124744415283, 4.918796539306641, 5.431621074676514, 5.247473239898682, 5.023876190185547, 5.391635894775391, 5.418959617614746, 5.239113807678223, 5.042668342590332, 5.438253402709961, 5.728262901306152, 5.502519607543945, 5.2353997230529785, 5.350951194763184, 5.242989540100098, 5.343756675720215, 5.713426113128662, 5.6904096603393555, 5.1100616455078125, 5.149363040924072, 5.042675971984863, 5.443427085876465, 4.995906829833984, 5.10377311706543, 5.410019397735596, 5.08161735534668, 5.307133674621582, 5.292069435119629, 5.255267143249512, 5.156691074371338, 5.561367034912109, 5.096119403839111, 5.433117389678955, 5.341620922088623, 5.419081211090088, 5.570847034454346, 5.170494079589844, 5.2772297859191895, 5.245430946350098, 5.111738204956055, 5.443270683288574, 4.961241245269775, 4.958014488220215, 5.085393905639648, 5.095254898071289, 5.199220180511475, 5.132205009460449, 5.204760551452637, 5.144446849822998, 5.412058353424072, 5.584427356719971, 5.911064147949219, 5.751983642578125, 5.281275749206543, 5.314406394958496, 5.744341850280762, 4.626309871673584, 5.054619789123535, 5.633773326873779, 5.419430732727051, 5.471550941467285, 5.132818222045898, 5.13505744934082, 5.15376091003418, 4.991021156311035, 5.15557861328125, 4.995131492614746, 5.143355369567871, 5.118399143218994, 4.758315563201904, 5.031304359436035, 5.181886672973633, 4.789873123168945, 5.245849609375, 5.16688346862793, 4.9148406982421875, 5.381389617919922, 5.276390552520752, 5.3202996253967285, 5.275509834289551, 4.938802719116211, 5.388436794281006, 5.24534273147583, 5.265542030334473, 5.24481201171875, 5.160165786743164, 5.435546398162842, 5.279983043670654, 5.318422317504883, 4.736410140991211, 5.465132713317871, 5.393467903137207, 5.188449382781982, 5.055899143218994, 5.3045830726623535, 5.0841965675354, 5.487054824829102, 5.061253547668457, 5.111061096191406, 5.2657012939453125, 5.092281818389893, 5.477118968963623, 5.024427890777588, 5.31233024597168, 5.436662673950195, 5.1077399253845215, 5.312851905822754, 5.254987716674805, 5.124186038970947, 5.2129669189453125, 5.116581439971924, 5.137977600097656, 5.438777923583984, 5.147928714752197, 5.06557559967041, 4.923976898193359, 5.268826961517334, 5.497862815856934, 5.126601696014404, 5.311047077178955, 5.474635124206543, 5.3226776123046875, 5.268956661224365, 5.309335708618164, 5.455187797546387, 5.305100917816162, 5.105838298797607, 5.164857864379883, 5.08190393447876, 5.217720031738281, 5.365724563598633, 5.149499416351318, 4.9489665031433105, 5.208736419677734, 5.07710599899292, 5.341139316558838, 5.349327087402344, 5.2774882316589355, 5.040478706359863, 5.450251579284668, 5.397568702697754, 5.404848575592041, 5.601272106170654, 5.37244176864624, 5.356063365936279, 4.941473007202148, 5.169097900390625, 5.3034892082214355, 5.117247104644775, 5.702087879180908, 5.435567855834961, 4.908302307128906, 5.155994415283203, 5.638440132141113, 5.1563029289245605, 5.134635925292969, 4.896514892578125, 5.139523029327393, 5.059229850769043, 5.119204044342041, 5.406469345092773, 5.3972673416137695, 5.288425445556641, 5.197020053863525, 5.106208324432373, 5.015985488891602, 5.396910667419434, 4.94264030456543, 5.272867202758789, 5.017120838165283, 5.135209560394287, 5.127645015716553, 5.520988941192627, 4.954178810119629, 5.04573392868042, 4.835503101348877, 5.319645881652832, 4.981767654418945, 4.8417744636535645, 5.13225793838501, 6.055591106414795, 4.8408284187316895, 4.744532108306885, 5.087967395782471, 4.88917350769043, 5.1240386962890625, 4.867646217346191, 4.910617351531982, 5.231966018676758, 5.067509651184082, 5.476629734039307, 5.013774871826172, 4.856022834777832]
ssmax_val_losses={0: 10.825848579406738, 125: 6.5537190437316895, 250: 6.114950656890869, 375: 5.888970375061035, 500: 5.745011806488037, 625: 5.5859527587890625, 750: 5.412529945373535, 875: 5.277693748474121, 1000: 5.208320617675781}

plt.figure(figsize=(16, 10))

# Plot training losses (faded lines)
plt.plot(base_train_losses, alpha=0.3, label='Base (train)', color='blue')
plt.plot(ssmax_train_losses, alpha=0.3, label='SSMax (train)', color='red')

# Plot validation losses (solid points)
val_steps = list(base_val_losses.keys())
base_val_values = list(base_val_losses.values())
ssmax_val_values = list(ssmax_val_losses.values())

plt.plot(val_steps, base_val_values, label='Base (val)', color='blue')
plt.plot(val_steps, ssmax_val_values, label='SSMax (val)', color='red')
plt.ylim(4.5, 7)

plt.xlabel('Steps (*8k tokens)')
plt.ylabel('Loss')
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
plt.savefig("ssmax.png")
